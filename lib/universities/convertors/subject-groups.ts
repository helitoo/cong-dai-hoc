import { JsonTable } from "@/public/data/json-table-model";

import {
  castToSubjectId,
  getSubjectName,
  SubjectId,
} from "@/lib/universities/convertors/subjects";

import { getExactData } from "@/lib/universities/general-helpers/get-exact-data";

export const subjectGroupIds = [
  "A000",
  "A001",
  "G001",
  "G002",
  "G003",
  "G004",
  "G005",
  "G006",
  "G007",
  "G008",
  "G009",
  "G010",
  "G011",
  "G012",
  "G013",
  "G014",
  "G015",
  "G016",
  "G017",
  "G018",
  "G019",
  "G020",
  "G021",
  "G022",
  "G023",
  "G024",
  "G025",
  "G026",
  "G027",
  "G028",
  "G029",
  "G030",
  "G031",
  "G032",
  "G033",
  "G034",
  "G035",
  "G036",
  "G037",
  "G038",
  "G039",
  "G040",
  "G041",
  "G042",
  "G043",
  "G044",
  "G045",
  "G046",
  "G047",
  "G048",
  "G049",
  "G050",
  "G051",
  "G052",
  "G053",
  "G054",
  "G055",
  "G056",
  "G057",
  "G058",
  "G059",
  "G060",
  "G061",
  "G062",
  "G063",
  "G064",
  "G065",
  "G066",
  "G067",
  "G068",
  "G069",
  "G070",
  "G071",
  "G072",
  "G073",
  "G074",
  "G075",
  "G076",
  "G077",
  "G078",
  "G079",
  "G080",
  "G081",
  "G082",
  "G083",
  "G084",
  "G085",
  "G086",
  "G087",
  "G088",
  "G089",
  "G090",
  "G091",
  "G092",
  "G093",
  "G094",
  "G095",
  "G096",
  "G097",
  "G098",
  "G099",
  "G100",
  "G101",
  "G102",
  "G103",
  "G104",
  "G105",
  "G106",
  "G107",
  "G108",
  "G109",
  "G110",
  "G111",
  "G112",
  "G113",
  "G114",
  "G115",
  "G116",
  "G117",
  "G118",
  "G119",
  "G120",
  "G121",
  "G122",
  "G123",
  "G124",
  "G125",
  "G126",
  "G127",
  "G128",
  "G129",
  "G130",
  "G131",
  "G132",
  "G133",
  "G134",
  "G135",
  "G136",
  "G137",
  "G138",
  "G139",
  "G140",
  "G141",
  "G142",
  "G143",
  "G144",
  "G145",
  "G146",
  "G147",
  "G148",
  "G149",
  "G150",
  "G151",
  "G152",
  "G153",
  "G154",
  "G155",
  "G156",
  "G157",
  "G158",
  "G159",
  "G160",
  "G161",
  "G162",
  "G163",
  "G164",
  "G165",
  "G166",
  "G167",
  "G168",
  "G169",
  "G170",
  "G171",
  "G172",
  "G173",
  "G174",
  "G175",
  "G176",
  "G177",
  "G178",
  "G179",
  "G180",
  "G181",
  "G182",
  "G183",
  "G184",
  "G185",
  "G186",
  "G187",
  "G188",
  "G189",
  "G190",
  "G191",
  "G192",
  "G193",
  "G194",
  "G195",
  "G196",
  "G197",
  "G198",
  "G199",
  "G200",
  "G201",
  "G202",
  "G203",
  "G204",
  "G205",
  "G206",
  "G207",
  "G208",
  "G209",
  "G210",
  "G211",
  "G212",
  "G213",
  "G214",
  "G215",
  "G216",
  "G217",
  "G218",
  "G219",
  "G220",
] as const;

export type SubjectGroupId = (typeof subjectGroupIds)[number];

const subjectGroupTable = await new JsonTable().load("subject-groups");

export function getSubjectsFromGroup(groupId: SubjectGroupId) {
  return [
    subjectGroupTable.getValByField(groupId, "id", ["subject1"]),
    subjectGroupTable.getValByField(groupId, "id", ["subject2"]),
    subjectGroupTable.getValByField(groupId, "id", ["subject3"]),
  ] as [SubjectId, SubjectId, SubjectId];
}

export function castToGroupId(groupId: any): SubjectGroupId {
  if (subjectGroupIds.includes(groupId)) return groupId;
  else return "G001";
}

export function getSubjectGroupName(
  groupId: SubjectGroupId,
  isGetLongForm: boolean = false
) {
  const subjects = getSubjectsFromGroup(groupId);
  return `${getSubjectName(
    castToSubjectId(subjects[0]),
    isGetLongForm
  )}-${getSubjectName(
    castToSubjectId(subjects[1]),
    isGetLongForm
  )}-${getSubjectName(castToSubjectId(subjects[2]), isGetLongForm)}`;
}

export function getExactSubjectGroupFromName(subjectGroupName: string) {
  const realSubjectGroupIds = subjectGroupIds.slice(2);
  // console.log(realSubjectGroupIds);
  return getExactData(
    subjectGroupName,
    realSubjectGroupIds.map((groupId) => getSubjectGroupName(groupId)),
    realSubjectGroupIds
  );
}
